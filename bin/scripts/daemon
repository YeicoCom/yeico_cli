#!/bin/bash

APP_NAME=$1
APP_RUN=/apps/$APP_NAME/bin/$APP_NAME
APP_TMP=/apps/$APP_NAME/tmp
APP_ERTS=/usr/lib/erlang/erts-14.0.2

ln -sf $APP_ERTS /apps/$APP_NAME/
mkdir -p $APP_TMP
mount tmpfs -t tmpfs $APP_TMP
mount -o remount,ro /apps
$APP_RUN daemon

while true; do
sleep 1
($APP_RUN pid) && break
done
